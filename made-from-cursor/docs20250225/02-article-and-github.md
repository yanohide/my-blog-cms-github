# Step 2: サンプル記事を作って GitHub と連携する

このステップでは、サンプルのブログ記事を作成して Sanity にアップロードし、ソースコードを GitHub で管理できるようにします。**ゴールはブログ記事がローカルサイトに表示され、コードが GitHub にバックアップされていること**です。

---

## 目次

1. [サンプル記事を作成する](#1-サンプル記事を作成する)
2. [Sanity Studio から記事を投稿する](#2-sanity-studio-から記事を投稿する)
3. [ローカルサイトで記事を確認する](#3-ローカルサイトで記事を確認する)
4. [GitHub のアカウント登録](#4-github-のアカウント登録)
5. [Git のインストール確認と初期設定](#5-git-のインストール確認と初期設定)
6. [GitHub リポジトリの作成と連携](#6-github-リポジトリの作成と連携)
7. [コードを GitHub にプッシュする](#7-コードを-github-にプッシュする)
8. [ここまでの確認](#8-ここまでの確認)
9. [よくあるトラブルと対処](#9-よくあるトラブルと対処)

---

## 1. サンプル記事を作成する

`blog/` フォルダにマークダウンファイルを作成します。Cursor でプロジェクトフォルダを開いてください。

> **参考**: `docs/samples/` フォルダに 3 本のサンプル記事を用意しています。記事の書き方やフォーマットの参考にしてください。
>
> | ファイル | 内容 |
> |---------|------|
> | [`design-system-philosophy.md`](./samples/design-system-philosophy.md) | デザインシステムの哲学について |
> | [`nextjs-sanity-blog.md`](./samples/nextjs-sanity-blog.md) | Next.js と Sanity でのブログ構築について |
> | [`power-of-whitespace.md`](./samples/power-of-whitespace.md) | ウェブデザインにおけるホワイトスペースについて |

### ファイルの作成

1. `blog/` フォルダがない場合は右クリック → **「New Folder」** で `blog` を作成します
2. `blog/` フォルダを右クリック → **「New File」**
3. ファイル名を入力します（例：`my-first-post.md`）

**ファイル名のルール：**
- 末尾は `.md`
- スペースは使わない（代わりにハイフン `-` を使う）
- 日本語のファイル名も使えます（例：`はじめてのブログ記事.md`）

### 記事を書く

ファイルの先頭に **Front Matter**（記事の設定情報）を書き、その下に本文を書きます。

```markdown
---
title: "はじめてのブログ記事"
slug: my-first-post
publishedAt: 2026-02-12
---

これは最初のブログ記事です。Sanity と Next.js で作ったブログサイトがちゃんと動くか確認するために書いています。

## 見出しのテスト

こんなふうに見出しや太字（**太字**）も使えます。

- 箇条書きその 1
- 箇条書きその 2
- 箇条書きその 3

> これは引用ブロックです。
```

| 項目 | 説明 | 例 |
|------|------|-----|
| `title` | 記事のタイトル。日本語 OK | `"はじめてのブログ記事"` |
| `slug` | URL になる文字列。半角英数字+ハイフン | `my-first-post` |
| `publishedAt` | 公開日時。`年-月-日` の形式（Sanity 側は datetime 型なので時刻は自動補完されます） | `2026-02-12` |

---

## 2. Sanity Studio から記事を投稿する

開発サーバーが動いている状態（`npm run dev`）でブラウザから操作します。

1. ブラウザで `http://localhost:3000/studio` を開きます
2. Google アカウントでログインします
3. 左メニューの **「Post」** をクリックします
4. **「Create new Post」** をクリックします
5. 以下の項目を入力します：

| 項目 | 入力内容 |
|------|---------|
| **Title** | はじめてのブログ記事 |
| **Slug** | **「Generate」** ボタンをクリック |
| **Published At** | 今日の日付を選択 |
| **Body** | マークダウンファイルの本文（Front Matter の下）をコピー＆ペースト |

6. 画面下部の **「Publish」** ボタンをクリックします
7. ボタンが緑色に変わり「Published」と表示されれば完了です

> **Body 欄へのコピペ時の注意**: マークダウンの記号（`##` や `**`）がそのまま書式に変換されない場合があります。その場合はツールバーから手動で見出しや太字を設定してください。

---

## 3. ローカルサイトで記事を確認する

1. ブラウザで `http://localhost:3000` を開きます
2. トップページに記事のタイトルが表示されていることを確認します
3. タイトルをクリックして、記事の詳細ページが表示されることを確認します

> **表示されない場合**: ページを再読み込み（`Cmd+R` / `F5`）してみてください。反映に最大 60 秒かかることがあります。

🎉 **おめでとうございます！ブログ記事が表示できました。** ここから先は、コードのバックアップのために GitHub と連携します。

---

## 4. GitHub のアカウント登録

**GitHub（ギットハブ）** は、コードの変更履歴を管理するバックアップサービスです。

1. ブラウザで [https://github.com](https://github.com) を開きます
2. **「Sign up」** をクリックします
3. メールアドレス、パスワード、ユーザー名を入力します
4. メールに届く確認コードを入力して登録を完了します

---

## 5. Git のインストール確認と初期設定

**Git（ギット）** は、コードの変更履歴を管理するソフトウェアです。

### インストール確認

Cursor のターミナル（`` Ctrl+` ``）で以下を実行します：

```bash
git --version
```

- `git version 2.xx.x` と表示されれば OK
- **Mac** で「コマンドライン・デベロッパツールが必要です」と出たら **「インストール」** をクリック
- **Windows** で「認識されていません」と出たら [https://git-scm.com](https://git-scm.com) からインストール

### 初期設定

名前とメールアドレスを設定します（変更履歴に記録されます）：

```bash
git config --global user.name "あなたの名前"
git config --global user.email "あなたのメールアドレス"
```

---

## 6. GitHub リポジトリの作成と連携

**リポジトリ** とは、プロジェクト専用のフォルダ（保管庫）です。

### ブラウザでリポジトリを作成

1. [https://github.com](https://github.com) にログインします
2. 右上の **「+」** → **「New repository」** をクリックします
3. 以下を入力します：
   - **Repository name**: プロジェクト名（例：`my-blog`）
   - **Public / Private**: **Private**（非公開）を推奨
4. **「Create repository」** をクリックします

### パソコンのプロジェクトとリポジトリを紐づける

Cursor のターミナルでプロジェクトフォルダにいることを確認して、以下を順番に実行します：

```bash
git init
git remote add origin https://github.com/あなたのユーザー名/リポジトリ名.git
```

> **URL はどこにある？** リポジトリを作成した直後の画面にコピーできる形で表示されています。

### .gitignore の確認

アップロードする前に、`.gitignore` ファイルに `.env*` の行があることを確認してください。秘密情報（トークン）を含む `.env.local` が GitHub にアップロードされるのを防ぎます。

---

## 7. コードを GitHub にプッシュする

すべてのファイルを GitHub にアップロードします。

```bash
git add .
git commit -m "最初のコミット"
git branch -M main
git push -u origin main
```

> 初回のプッシュ時に GitHub の認証を求められることがあります。パスワードの代わりに **Personal Access Token** が必要です：
>
> 1. GitHub → 右上アイコン → **Settings** → **Developer settings** → **Personal access tokens** → **Fine-grained tokens**
> 2. **「Generate new token」** をクリック
> 3. **Repository access** で対象リポジトリを選択
> 4. **Permissions** → **Contents** を **Read and write** に設定
> 5. トークンを生成してコピーし、パスワードの代わりに使用

---

## 8. ここまでの確認

以下がすべてクリアできていれば、Step 2 完了です！

- [ ] `blog/` フォルダにサンプル記事のマークダウンファイルがある
- [ ] Sanity Studio で記事を投稿し「Published」になっている
- [ ] `http://localhost:3000` で記事が表示されている
- [ ] GitHub のリポジトリにコードがアップロードされている
  - ブラウザで `https://github.com/あなたのユーザー名/リポジトリ名` を開いて確認

---

## 9. よくあるトラブルと対処

### 「git: command not found」と表示される

Git がインストールされていません。[手順 5](#5-git-のインストール確認と初期設定) に戻ってインストールしてください。

### 「rejected」「non-fast-forward」と表示される

GitHub 上のコードがパソコンより新しい場合に起きます。以下で最新状態を取得してください：

```bash
git pull
```

### 「Authentication failed」と表示される

トークンの有効期限が切れています。[手順 7](#7-コードを-github-にプッシュする) を参考にトークンを再発行してください。

### 記事が `localhost` に表示されない

- Sanity Studio で記事が **「Published」** になっているか確認
- **Slug** が空欄でないか確認（空欄なら **「Generate」** を押す）
- ページを再読み込み（`Cmd+R`）してみてください

---

前のステップ ← [Step 1: ブログサイトをローカルで動かす](./01-local-setup.md)
次のステップ → [Step 3: ブログサイトを Web で公開する](./03-vercel-deploy.md)
